{"componentChunkName":"component---src-templates-blog-post-js","path":"/setSeo/","result":{"data":{"site":{"siteMetadata":{"title":"neekoblog"}},"markdownRemark":{"id":"741efbeb-4984-5680-adb6-2706a10c001f","excerpt":"개요 \n기존에 어떤 페이지든 위처럼 보이던 방식을\n페이지마다 사진과 글이 포함되면 그 내용을 보여주도록 설정한다. stack: next.js, firebase useParams에서 Id를 가져와서 firebase에서 검색 후 페이지 데이터를 가져온다. 가져온 데이터로 metadata…","html":"<h3>개요</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/neekoblog/static/cfb6296d3ace46b814c899b74cba7882/e85cb/before.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEwUlEQVR42o2SaUyUVxSGP/unIE20amqD0R8NagoOyDoMA4JVpA3pEmvStEmXuNTaYtWmiUi0f2pN06S1uNRoYbQqVVEECwgoCLLDMAMDgyxCkK2AMwwywyysT+98QH80RnuTJ+89556895z7fdK2txfz3YGFJH7lSWKCF4f2esokJghNWCiTKOM1x2zu0N6FJO2dr/HgyH5PPv1gEVL2tYVgW87jrlWM/f0Kpu7XGOldia1/ueBVRvu8sQodEzgHlsrqzlv6VmDpWSWfD3evxGFaQVvti0h/XfSit9OX0soImvQKdHUhlFVFUVOjpE7s3VTVhAtUaLWhMga9PwZdALVaJc0NfpRVqhjoXEPxDQ+k3BueDJsUGI3hPGwPpa1dSXtbEC0tSlpa1XS0B4k4mKYHkSIXgWXAG8YkZqwviMkWgHUBU6NCkSjNFx0e3v8SWZcWcSVlGRfPLCU1ebGIl3E1ZSnnjr/M1dRlpJ1bQtrZJbJeTxX1Gg8yNZ5zeJCR4kn+nx78kOiFdOKUhkZjB1euVrL9yzvs+baIg4eLOZBYxI6v73LwyD2qqhooK6unokJouYHSssZZyme1pLSBOl0nJ4WXdL+0FPdKTbNQ0TxJQeU4hbUTFGonKDVMkp5nR6t3yjXT0zx1TU1NyVoqvKRbtwq5lD5KVpGJUxf68fapovqBjaPJ3awOqKGiaZRT5/spKjELwyn6h530zTEw4qLX7KTHbMci7swtKEJKOJBJRuE4eRUjlOhtvPNRC829Ls5fN/HxnnaMPS7SCyycvjiEzjBGp1lMobNS1jyGvsNJY984+bUWqtrhcoYw3JVwk8wCJ96rqymuszHknObn3wdIyx7GIcZIOtbDenU9hRVPyLptweSa5uHQOCW6UZ44pumyTKJ/aMP4CHLulogOv8nknm6KxKNdVDfb+f6XPtYG6gmMbCCzcIQLGSaOpwzwR6YZXYONwbFpukcmMXQ6cE7N8EjsjT12hsYgz22Yk1vMuctWOkwufjzdL3ez4a0mVLGNhG00iE5sFIunuHxtSH741v5x7mit1HXY6TZP0Nzv4naFhTZxnJlXjFRTXU5WnpOSBitRbzbxeoieCGHmZuVarei8m5uiU129TTY0PnJSaRyjptUuzF3Ui06rmq0YxMgZOfeQtLXlVNfBzSIb+VUOkjVmruRZSb9jk/f3G1xo0kcYGJyQDWdmnvPb5ObmYLc7OKt5wE+/tXBC084ZTRsnU1r5NbWNY8kt5OZ3YbUOYzKZZR4/nmU+HhwcwuFwkZ2dgxQYGEjMxhhiYtQoFCp8fZVsjI5EHaFmzZowgoMj2LQpigi1GvUziIqKwu0l+fn5sW/fPpKSkti9e6cwWC8OgggKCkKpDCYkJEgudMfPIiQkRDTji6RQKIiNjSUuLo7o6GhhoiQsLEzWeUJDQ5+Lu87tJfn7+4uR3mDz5s3Ex8fLxlu2uNki5+PcKs7cl/wvQ4UwVKk3ECYSKlWE0HDCw1VCVaIwbDZWqQkNU87yPMOA9YFs2LqDyPd3o37nE6K2fYH6ve1Ebt1J5Lufifznc/Eu1PEfovzPc8yjUqlwTyv5+PiwTuGPn5t1cyoTgO+/uYBZ/NbJD/803B/X7fUPdpmFtUVKtG0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"before\"\n        title=\"\"\n        src=\"/neekoblog/static/cfb6296d3ace46b814c899b74cba7882/e85cb/before.png\"\n        srcset=\"/neekoblog/static/cfb6296d3ace46b814c899b74cba7882/fac75/before.png 125w,\n/neekoblog/static/cfb6296d3ace46b814c899b74cba7882/63868/before.png 250w,\n/neekoblog/static/cfb6296d3ace46b814c899b74cba7882/e85cb/before.png 480w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n기존에 어떤 페이지든 위처럼 보이던 방식을\n페이지마다 사진과 글이 포함되면 그 내용을 보여주도록 설정한다.</p>\n<p>stack: next.js, firebase</p>\n<p>useParams에서 Id를 가져와서 firebase에서 검색 후 페이지 데이터를 가져온다.</p>\n<p>가져온 데이터로 metadata를 설정해야하는데 이때 metadata는 \"use client\"를 사용해선 안되고 서버에서 작업이 이루어져야한다.</p>\n<h4>Why?</h4>\n<p>검색엔진과 소셜미디어 Bot은 javascript를 실행하지 않고 HTML만 읽어간다.</p>\n<p>link를 통해 meta데이터를 파악하고 보여줄 때 직접 홈페이지에 들어가서 javascript를 모두 실행하는것을 기다려주지 않는다.\n\"use client\"는 빈 HTML을 받고 javascript 번들을 다운 후 실행한다.\nSSR은 서버에서 데이서 fetching을 완료하고 metadata가 포함된 HTML을 생성해서 보낸다.\n따라서 봇이 바로 접속하자마자 tag나 meta data를 읽을 수 있다.</p>\n<p>Open Graph의 경우\nURL에 get 요청을 보낸후 반환되는 head에 포함된 metadata를 긁는다.</p>\n<h3>How</h3>\n<p>\"use client\"로 되어있는 부분을 client Component로 분리하고 page.tsx에서는 SSR 방식으로 진행했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import { Metadata } from 'next';\nimport ReadPostContent from '@/packages/ui/components/home/read/ReadPostContent';\nimport { getPostById } from '@/lib/api/post';\n\nfunction extractText(html: string | undefined): string {\n  if (!html) return '';\n  return html\n    .replace(/&lt;[^>]*>/g, '')\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n\nfunction extractFirstImage(html: string | undefined): string | null {\n  if (!html || typeof html !== 'string') {\n    return null;\n  }\n  const imgRegex = /&lt;img[^>]+src=[\"']([^\"']+)[\"'][^>]*>/i;\n  const match = html.match(imgRegex);\n  return match &amp;&amp; match[1] ? match[1] : null;\n}\n\nexport async function generateMetadata({\n  params,\n}: {\n  params: Promise&lt;{ id: string }>;\n}): Promise&lt;Metadata> {\n  const { id: postId } = await params;\n\n  const baseUrl =\n    process.env.NEXT_PUBLIC_SITE_URL ||\n    (process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : null) ||\n    'http://localhost:3001';\n\n  try {\n    const post = await getPostById(postId);\n\n    if (post) {\n      const title = post.title || '게시물';\n      const description =\n        extractText(post.content).substring(0, 160) || '꼬순내 게시물';\n\n      let imageUrl = extractFirstImage(post.content);\n      if (imageUrl) {\n        if (imageUrl.startsWith('/')) {\n          imageUrl = `${baseUrl}${imageUrl}`;\n        } else if (!imageUrl.startsWith('http')) {\n          imageUrl = `${baseUrl}/${imageUrl}`;\n        }\n      } else {\n        imageUrl = `${baseUrl}/static/images/defaultDogImg.png`;\n      }\n\n      const url = `${baseUrl}/read/${postId}`;\n\n      return {\n        title: `${title} | 꼬순내`,\n        description,\n        metadataBase: new URL(baseUrl),\n        openGraph: {\n          title,\n          description,\n          url,\n          siteName: '꼬순내',\n          images: [\n            {\n              url: imageUrl,\n              width: 1200,\n              height: 630,\n              alt: title,\n            },\n          ],\n          locale: 'ko_KR',\n          type: 'article',\n        },\n        twitter: {\n          card: 'summary_large_image',\n          title,\n          description,\n          images: [imageUrl],\n        },\n      };\n    }\n  } catch (error) {\n    console.error('메타데이터 생성 중 오류:', error);\n  }\n\n  const defaultImageUrl = `${baseUrl}/static/images/defaultDogImg.png`;\n\n  return {\n    title: '게시물 | 꼬순내',\n    description: '꼬순내 게시물',\n    metadataBase: new URL(baseUrl),\n    openGraph: {\n      title: '게시물 | 꼬순내',\n      description: '꼬순내 게시물',\n      url: `${baseUrl}/read/${postId}`,\n      siteName: '꼬순내',\n      images: [\n        {\n          url: defaultImageUrl,\n          width: 1200,\n          height: 630,\n          alt: '꼬순내',\n        },\n      ],\n      locale: 'ko_KR',\n      type: 'article',\n    },\n    twitter: {\n      card: 'summary_large_image',\n      title: '게시물 | 꼬순내',\n      description: '꼬순내 게시물',\n      images: [defaultImageUrl],\n    },\n  };\n}\n\nexport default async function ReadPostPage({\n  params,\n}: {\n  params: Promise&lt;{ id: string }>;\n}) {\n  const { id: postId } = await params;\n  const post = await getPostById(postId);\n\n  return &lt;ReadPostContent postId={postId} initialPost={post} />;\n}</code></pre></div>","frontmatter":{"title":"페이지마다 meta 설정하기","date":"December 08, 2025","description":"꼬순내를 개발하면서 페이지 공유 할때 meta 설정하기"}},"previous":{"fields":{"slug":"/retreo2025/"},"frontmatter":{"title":"2025년 회고록"}},"next":{"fields":{"slug":"/gifDataProcessing/"},"frontmatter":{"title":"Gif를 어떻게 효율적으로 저장할까?"}}},"pageContext":{"id":"741efbeb-4984-5680-adb6-2706a10c001f","previousPostId":"4a244e75-db3a-5879-b54d-8ee20a1ecae7","nextPostId":"98552beb-5ba3-5842-9846-120998d2170c"}},"staticQueryHashes":["1469588348","2841359383"],"slicesMap":{}}