{"componentChunkName":"component---src-templates-blog-post-js","path":"/closure/","result":{"data":{"site":{"siteMetadata":{"title":"neekoblog"}},"markdownRemark":{"id":"7814bdd0-08d7-56b8-a228-de5a6c8a7474","excerpt":"🔖 Closure는함수형 프로그래밍 언어에 등장한다. MDN의 Closure 정의 “A closure is the combination of a function and the lexical environment within which that function was declared…","html":"<h4>🔖 Closure는함수형 프로그래밍 언어에 등장한다.</h4>\n<p>MDN의 Closure 정의</p>\n<blockquote>\n<p>“A closure is the combination of a function and the lexical environment within which that function was declared.”</p>\n</blockquote>\n<blockquote>\n<p>클로저는 함수와 그 함수가 선언된 환경정보의 조합이다.</p>\n</blockquote>\n<h2>Closure</h2>\n<p>외부함수보다 중첩함수가 더 오래 유지되는 경우 (생명주기가 종료된 외부함수의 변수를 중첩함수 내부에서 참조하는 현상)</p>\n<p>원래는 함수가 리턴하면 함수 내의 변수들은 GC에 의해 사라진다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">inner</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> inner\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> innerFunc <span class=\"token operator\">=</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">innerFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//✅ 10</span></code></pre></div>\n<p>outer가 inner를 반환한 시점에서 outer의 LifeCycle은 끝이 났다.<br/>\n하지만 innerFunc은 outer안에 있는 지역변수 x의 값을 찍고 있다.</p>\n<p>\"x는 private 변수이다 -> closure로 priovate 변수를 만들 수 있다.\"</p>\n<p>inner함수가 평가될 때 inner 함수의 환경에는 상위 스코프에 대한 정보가 있을 것이다.<br/>\nouter 함수는 평가될 때 전역 스코프를 함수의 환경 정보에 저장하고 있을 것이다.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/95c1f/closure_1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 23.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTklEQVR42m2Oz0obURSH83YG24VQsQtpN/YB+gDdFN9AEPcFhW4KLdU0hiQq6CpaCSmkFJNMMvfOTCbeyb+5c+9Mk8+Law8cPn6/cxZfSfXrJMMLVL/GYtzFqjY6aJDJS3TvjDxsUcQddP+UzKuR9ipYee26tssVd3dsf0ffnqBbx5T86iuCxg5hrYy8O2Byt8+4uUV8tYusvmb6+zPLf18IG28JLz8QXbxD3X5i2jkgOi8z/XOEauwx/rFBcLpJSYgQKUOiaII/EiSzOcYWpJllvkiJJnOUaDHufiX6+43Z4Cfxwy/iOEZNU0eFGYywPY+5J5yhNyTwBf5whBQClSiEo5SCSRzxmGjC+0OC+htE8z1edZvg5iNGJxhjsdZgV/+fN7OWkhSSQa+P8H2Wi6V7sGit0VmGNYY8z7F5gS1WpKZgkebOPme9XvPSPAFTOmVLx051zAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"closure_1\" title=\"\" src=\"/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/0b533/closure_1.png\" srcset=\"/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/fac75/closure_1.png 125w,\n/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/63868/closure_1.png 250w,\n/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/0b533/closure_1.png 500w,\n/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/1d69c/closure_1.png 750w,\n/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/00d43/closure_1.png 1000w,\n/neekoblog/static/e3ed979fee6ff69f920a38a2b201ee2b/95c1f/closure_1.png 2330w\" sizes=\"(max-width: 500px) 100vw, 500px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span><br/></p>\n<p>outer 함수가 return 하면 해당 실행 컨텍스트는 제거되고 생명주기도 끝나지만<br/>\nouter의 렉시컬 환경은 내부 슬롯에 저장되어있다.</p>\n<p><b>그러면 해당 변수는 닿을 수 있는 오브젝트가 되는것이다. -> GC의 대상 === 닿을 수 없는 오브젝트</b></p>\n<p>inner 함수가 외부 렉시컬 환경을 outer 함수로 참조하고 있기 때문에 GC가 함부로 가져가지 않는다.<br/>\n이러한 현상을 클로저라고 한다.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/31df8/closure_2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 44.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACAUlEQVR42l2SS2sUQRSF58e5URcBN24Fd4LLuFAScRF3ElfBCOpKwY24CRhjRAO+mDyETF5DEpOeTL+nu6u7qt/dn5UZkWhRp05xq+65VXWqw3+tbUraSlDnIXnikqea04hc6rn0xsjSBNc6wTT2sIx9lIz/5ncuKI2p8L7jf5rCXL2GuXyFYHOGaGce58NlrI/XsVaukg1XsLsPGCxdwng3hXB6EwmtoQVb3WuN6jxEqgTGcY+jg5+45iGBNyAObcTIQMUO0TnLEBFYRP5gjEwEUJX6NPmFE/5pdduSa/0ka4iymjgtKJuWrG6pdG2l66q8GsfKutHrNYmqdayhkoqOdLdxf9zFX5/B23hIMniP3JljtDmL9XUacfCc+Og1fvcObndW77uHOn1LsHUfcfiS029zHK/e4tfnaWJnQCeydzjrPsLceIy5tYDdXyHuvxgj3H2C139DbOg325rH6z0l2F3EP17G7y0yOlrC23vFqLeAv/sMNXLoCKEY2im2l2PaCs+PiGRNEFeESYEbFWMhZ+0G9pfbWGs3CQdrKO2hzHNkUaNvTay5TlM6mVKYZwZD4wTXHpLEAhEFjHxXzyOUkkRun3DYRXnbJOY6eWxD04xNmCCDUnOWTUyRUieFIUVR/Psn28mQ5SVSm1NpY8qsohYJ2BY4Dliabc1DEyLBbwHTlonUbvARAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"closure_2\" title=\"\" src=\"/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/0b533/closure_2.png\" srcset=\"/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/fac75/closure_2.png 125w,\n/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/63868/closure_2.png 250w,\n/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/0b533/closure_2.png 500w,\n/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/1d69c/closure_2.png 750w,\n/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/00d43/closure_2.png 1000w,\n/neekoblog/static/910e55dd28792820e6a0ac05710e1caa/31df8/closure_2.png 2366w\" sizes=\"(max-width: 500px) 100vw, 500px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span><br/></p>\n<p>inner 함수를 반환 받은 innerFunc에 의해 inner 함수가 더 오래 생존하게 된 것이다.<br/>\n즉 inner 함수의 외부 렉시컬 환경에 outer의 x가 들어있기 때문에 innerFunc에서 10이 나오는 것이다.</p>\n<p>상위 스코프의 어떤 식별자도 참조하지 않는 경우 대부분의 모던 브라우저는 최적화를 통해 상위 스코프를 기억하지 않는다. 따라서 Closure라고 말할 수 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> hidden <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">inner</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">42</span> <span class=\"token comment\">// hidden을 사용하지 않음</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> fn <span class=\"token operator\">=</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 42</span></code></pre></div>\n<p>이게 예시인데 브라우저에 따라 최적화에 실패할 경우 메모리 누수가 발생할 수 있다. <br/>\nClosure를 사용하고 나서도 메모리 누수가 발생할 수 있기 때문에 후처리가 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">inner</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  inner<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">clear</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span> <span class=\"token comment\">// 내부에서 접근 가능</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> inner\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> innerFunc <span class=\"token operator\">=</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">innerFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 10</span>\ninnerFunc<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// x를 null로 설정</span>\n<span class=\"token function\">innerFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// null</span></code></pre></div>","frontmatter":{"title":"Closure","date":"February 23, 2025","description":"Closure는 함수형 프로그래밍 언어에 등장한다."}},"previous":{"fields":{"slug":"/threeJs1/"},"frontmatter":{"title":"Three.js 블로그에 붙이기 1탄"}},"next":{"fields":{"slug":"/higherOrder_function/"},"frontmatter":{"title":"고차 함수"}}},"pageContext":{"id":"7814bdd0-08d7-56b8-a228-de5a6c8a7474","previousPostId":"2e5bbfa0-53d6-5956-9f52-f229f4db86d3","nextPostId":"40ae2dcd-4a7c-50d5-b074-c4b48c5f3d81"}},"staticQueryHashes":["1469588348","2841359383"],"slicesMap":{}}